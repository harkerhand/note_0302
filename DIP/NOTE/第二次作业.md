## 原图像灰度矩阵 $f(x,y)$

---

$f(x,y)= \begin{bmatrix} 0 & 0 & 1 & 1 & 2 & 2 & 3 & 3 \\ 0 & 0 & 1 & 1 & 2 & 2 & 3 & 3 \\ 1 & 1 & 2 & 2 & 3 & 3 & 4 & 4 \\ 1 & 1 & 2 & 2 & 3 & 3 & 4 & 4 \\ 2 & 2 & 3 & 3 & 4 & 4 & 5 & 5 \\ 2 & 2 & 3 & 3 & 4 & 4 & 5 & 5 \\ 3 & 3 & 4 & 4 & 5 & 5 & 6 & 6 \\ 3 & 3 & 4 & 4 & 5 & 5 & 6 & 7 \end{bmatrix}$

---

### 统计灰度级直方图

|k|$n_k$|$p_k = n_k / 64$|
|---|---|---|
|0|4|0.0625|
|1|8|0.125|
|2|12|0.1875|
|3|16|0.25|
|4|12|0.1875|
|5|8|0.125|
|6|3|0.046875|
|7|1|0.015625|

---

### 计算累积分布函数 (CDF)

$\text{CDF}(k) = \sum_{i=0}^{k} p_i$

|k|CDF(k)|
|---|---|
|0|0.0625|
|1|0.1875|
|2|0.375|
|3|0.625|
|4|0.8125|
|5|0.9375|
|6|0.984375|
|7|1.000|

---

### 计算均衡化后的新灰度值

使用公式：

$s_k = \text{round}\big( (L-1) \times \text{CDF}(k) \big)$

其中 $L=8$。

|k|CDF(k)|$s_k = 7\times CDF(k)$|round|
|---|---|---|---|
|0|0.0625|0.4375|0|
|1|0.1875|1.3125|1|
|2|0.375|2.625|3|
|3|0.625|4.375|4|
|4|0.8125|5.6875|6|
|5|0.9375|6.5625|7|
|6|0.984375|6.890625|7|
|7|1.000|7.0|7|

---

### 对应变换表：

$\begin{aligned} 0 &\to 0 \\ 1 &\to 1 \\ 2 &\to 3 \\ 3 &\to 4 \\ 4 &\to 6 \\ 5 &\to 7 \\ 6 &\to 7 \\ 7 &\to 7 \end{aligned}$

---

### 均衡化后的结果矩阵 $f'(x,y)$

$f'(x,y)= \begin{bmatrix} 0 & 0 & 1 & 1 & 3 & 3 & 4 & 4 \\ 0 & 0 & 1 & 1 & 3 & 3 & 4 & 4 \\ 1 & 1 & 3 & 3 & 4 & 4 & 6 & 6 \\ 1 & 1 & 3 & 3 & 4 & 4 & 6 & 6 \\ 3 & 3 & 4 & 4 & 6 & 6 & 7 & 7 \\ 3 & 3 & 4 & 4 & 6 & 6 & 7 & 7 \\ 4 & 4 & 6 & 6 & 7 & 7 & 7 & 7 \\ 4 & 4 & 6 & 6 & 7 & 7 & 7 & 7 \end{bmatrix}$